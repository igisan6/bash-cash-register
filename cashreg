#!/bin/bash

function initialize() {
    cat <<EOF

Cash Register v0.1
 
EOF
}

function show_help() {
    cat<<EOF

Items
  d  list by description
  i  list by item number
  p  list by price
Transactions
  [[-]#] ####  add +/- quantity
  s  show cart
  t  show total
  a  abort transaction
  f  finalize transaction
Other
  q  quit

EOF
}

function list_description() {
    awk 'BEGIN{ print "Code     Price  Description" }; { printf "%s%10s  %s\n", $1, $2, $3 }' FS='\t' items.dat | (sed -u 1q; sort -k 3) | less
}

function list_number() {
    awk 'BEGIN{ print "Code     Price  Description" }; { printf "%s%10s  %s\n", $1, $2, $3 }' FS='\t' items.dat | (sed -u 1q; sort -k 1) | less
}

function list_price() {
    awk 'BEGIN{ print "Code     Price  Description" }; { printf "%s%10s  %s\n", $1, $2, $3 }' FS='\t' items.dat | (sed -u 1q; sort -k 2 -g) | less
}

function show_cart() {
    echo todo
}

function show_total() {
    echo todo
}

function abort_transaction() {
    echo todo
}

function finalize_transaction() {
    echo todo
}

function main() {
    initialize
    
    read -p 'Selection (h for help)? ' selection
    
    while [ $selection != q ]
    do
	case $selection in
	    h)
		show_help
		;;
	    d)
		list_description
		;;
	    i)
		list_number
	       	;;
	    p)
		list_price
		;;
	    s)
		show_cart
		;;
	    t)
		show_total
		;;
	    a)
		abort_transaction
		;;
	    f)
		finalize_transaction
		;;
	    q)
		exit 0
		;;
	esac
	read -p 'Selection (h for help)? ' selection
    done  
}

main
